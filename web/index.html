<!doctype html>
<html lang="fr">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="description" content="">
	<meta name="author" content="">
	<link rel="icon" href="favicon.ico">

	<title>La communauté des Curieux</title>

	<!-- Bootstrap core CSS -->
	<link href="css/bootstrap.min.css" rel="stylesheet">

	<!-- Custom styles for this template -->
	<link href="css/style.css" rel="stylesheet">
</head>

<body>

	<div class="d-flex flex-column flex-md-row align-items-center mb-3 bg-white border-bottom box-shadow">
		<img src="img/tag.jpg" style="width: 100%;height: auto;"/>
	</div>

	<div class="pricing-header px-3 py-3 pt-md-5 pb-md-4 mx-auto text-center">
		<h1 class="display-6">La Communauté des Curieux</h1>
		<p class="lead">Explorons la technologie blockchain ensemble</p>
		<p>Ce site web vous permettra d'interagir avec les contrats d'association de la blockchain Ethereum.</p>
		<p>Les informations vous concernant (clés privée et publique) sont stockées sur votre navigateur (extension MetaMask) ou sur votre application MetaMask. Les informations concernant les contrats sont stockés sur la blockchain directement. Aucune information personnelle, technique ou de nature blockchain n'est stockée sur nos serveurs. L'historique des transaction est stockée sur le navigateur pour simplifier la navigation. </p>
		<p>Ce site est simplement un intermédiaire intuitif et user-friendly pour manipuler des smart contracts de manière à respecter l'esprit de la désintermédiation. Bonne exploration.</p>
		<p> Toutes vos opérations, notifications et recherches sont disponibles dans l'onglet <span class="bold">Votre historique</span></p>
		<p>
			<span id="accountAddress" class="bold">
			Merci de connecter votre extension/application MetaMask ou de rafraichir la page afin de connecter la wallet. Si cela ne fonctionne pas, fermez et relancez le navigateur ou l'application Metamask.
			</span>
		</p>
		<p>
			<div id="network-problem">Merci de suivre cette procédure : 
				 <ol class="list-group">
					<li class="list-group-item">Installer Metamask (application dans le store si vous êtes sur mobile) ou extension Google Chrome si sur desktop</li>
					<li class="list-group-item">Configurer votre wallet Metamask (avec mot de passe)</li>
					<li class="list-group-item">Ajouter un nouveau réseau tel que décrit plus haut (avec Add network dans les paramètres puis renseigner dans RPC URL https://curieux.ma/blockchain/ puis 985459 dans chainId)</li>
					<li class="list-group-item">Accepter la connection au site (une pop-up devrait s'afficher)</li>
				  </ol>
			</div>
		</p>
	</div>
	
	<div class="container" style="display: none;">
		
		<div class="card-deck mb-3 text-center">

			<a name="ether"></a>
			<div class="card mb-4 box-shadow">
				<div class="card-header">
					<h4 class="my-0 font-weight-normal"><a style="cursor: pointer;" onclick="toggleBlock('recevoir')">Recevoir de l'ether</a></h4>
				</div>
				<div class="card-body recevoir-hide" style="display: none;">
					<ul class="list-unstyled mt-3 mb-4">
						<p>Mon solde d'ether de test doit être rechargé et je veux en recevoir une unité</p>
						<div id="received-ether"></div>
					</ul>
					<button onclick="getEther()" type="button" class="btn btn-lg btn-block btn-info">Recevoir</button>
				</div>
			</div>

			<a name="creat"></a>
			<div class="card mb-4 box-shadow">
				<div class="card-header">
					<h4 class="my-0 font-weight-normal"><a style="cursor: pointer;" onclick="toggleBlock('creer')">Créer mon association</a></h4>
				</div>
				<div class="card-body creer-hide" style="display: none;">
					<ul class="list-unstyled mt-3 mb-4">
						<p>Je désire créer une association et recevoir l'adresse de son contrat
						</p>
						<div id="created-assoc"></div>
						<div id="created-assoc-statut"></div>
					</ul>
					<input type="text" class="form-control mb-2" id="name-assoc" placeholder="Choisir un nom pour l'association">
					<input type="text" class="form-control mb-2" id="member-name-assoc" placeholder="Quel est votre pseudonyme ?">
					<button onclick="onCreateAssociationBtn()" type="button"
						class="btn btn-lg btn-block btn-success">Créer</button>
				</div>
			</div>

			<a name="reche"></a>
			<div class="card mb-4 box-shadow">
				<div class="card-header">
					<h4 class="my-0 font-weight-normal"><a style="cursor: pointer;" onclick="toggleBlock('rechercher')">Rechercher une association</a></h4>
				</div>
				<div class="card-body rechercher-hide" style="display: none;">
					<ul class="list-unstyled mt-3 mb-4">
						<p>Je dispose d'une adresse de contrat d'association et désire interagir avec</p>
					</ul>
					<input type="text" class="form-control mb-2" id="seek-assoc" placeholder="0xABCD1234...">
					<button onclick="seekAssociation()" type="button" class="btn btn-lg btn-block btn-primary mb-2">Rechercher</button>
				</div>
			</div>

			<div class="card mb-4 box-shadow" id="details-assoc" style="display:none;">
				<div class="card-header">
					<h4 class="my-0 font-weight-normal"><a style="cursor: pointer;" onclick="toggleBlock('details')">Détails de l'association</a></h4>
				</div>
				<div class="card-body details-hide" id="sought-assoc">
					<p><span class='title'>Association</span> <span id='name-seek-assoc'></span> : <span id='addassoc'></span></p>

					<div class="myassoc">
						<p><span class='title'>Président</span> : <span id="president"></span></p>
						<span id="become-owner" class="ismember">
							<button onclick="onBecomeOwner()" type="button" class="btn btn-lg btn-block btn-dark mb-2">Devenir président</button>
						</span>
						<div id="become-owner-statut"></div>
					</div>

					<div class="seassoc">
						<p><span class='title'>Président</span> : C'est vous !</p>
						<span id="destroy-assoc">
							<button onclick="onSelfDestruct()" type="button" class="btn btn-lg btn-block btn-danger mb-2">Dissoudre l'association</button>
						</span>
						<div id="destroy-assoc-statut"></div>
					</div>

					<div class="ismember">
						<p>J'en suis membre 
							<svg width='1em' height='1em' viewBox='0 0 16 16' class='bi bi-check-circle' fill='currentColor' xmlns='http://www.w3.org/2000/svg'> <path fill-rule='evenodd' d='M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z'/>                        <path fill-rule='evenodd' d='M10.97 4.97a.75.75 0 0 1 1.071 1.05l-3.992 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.236.236 0 0 1 .02-.022z'/> </svg>
						</p>
					</div>
					<div class="notmember" id="become-member">
						<p>Je ne suis pas membre 
							<svg width='1em' height='1em' viewBox='0 0 16 16' class='bi bi-emoji-dizzy' fill='currentColor' xmlns='http://www.w3.org/2000/svg'><path fill-rule='evenodd' d='M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z'/><path fill-rule='evenodd' d='M9.146 5.146a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708.708l-.647.646.647.646a.5.5 0 0 1-.708.708l-.646-.647-.646.647a.5.5 0 1 1-.708-.708l.647-.646-.647-.646a.5.5 0 0 1 0-.708zm-5 0a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 1 1 .708.708l-.647.646.647.646a.5.5 0 1 1-.708.708L5.5 7.207l-.646.647a.5.5 0 1 1-.708-.708l.647-.646-.647-.646a.5.5 0 0 1 0-.708z'/><path d='M10 11a2 2 0 1 1-4 0 2 2 0 0 1 4 0z'/></svg>
						</p>
						<input type="text" class="form-control mb-2" id="become-member-name" placeholder="Quel est votre pseudonyme ?">
						<button onclick="onJoinAssociation()" type="button" class="btn btn-lg btn-block btn-warning mb-2">Rejoindre l'association</button>
					</div>
					<div id="become-member-statut"></div>

					<p><span class='title'>Nombre de membres</span> : <span id="nbmembers"></span></p>
					<div id="member-ban-statut"></div>
					<div id="member-list"></div>

					<span id="ask-referendum" class="ismember">
						<h6>Demander un referendum</h6>
						<input type='text' class='form-control mb-2' id='ask-referendum-question' placeholder='Question fermée à poser (OUI/NON)'>
						<button onclick='onSendReferendum()' type='button' class='btn btn-lg btn-block btn-primary mb-2'>Proposer un referendum</button>
					</span>
					<div id="ask-referendum-statut"></div>
					<div id="referendum-list"></div>

				</div>
			</div>

			<a name="gesti"></a>
			<div class="card mb-4 box-shadow">
				<div class="card-header">
					<h4 class="my-0 font-weight-normal"><a style="cursor: pointer;" onclick="toggleBlock('gerer')">Gérer une association</a></h4>
				</div>
				<div class="card-body gerer-hide" style="display: none;">
					<ul class="list-unstyled mt-3 mb-4">
						<p>Je dispose d'un contrat d'une des opérations suivantes : cooptation, bannissement, dissolution, changement de propriétaire ou referendum pour lequel je veux voter ou l'acter</p>
						<span id="admin-select" style="display:none;"></span>
						
						<input type="text" class="form-control mb-2" id="seek-admin" placeholder="0xABCD1234...">
						<button onclick="onSeekAdminContract()" type="button" class="btn btn-lg btn-block btn-secondary mb-2">Rechercher</button>

						<div id="details-admin" style="display: none;">
							<p><span class='title'>Association</span> : <span id='addassoc-admin'></span></p>
							<p><span class='title'>Contrat d'administration (à copier et envoyer aux membres de l'association)</span> : <span id='addadmin-admin'></span></p>

							<p>
								Ce contrat <span class="bold" id="details-admin-type"></span><span class="bold" id="details-admin-member"></span>
							</p>
							<p>
								Il y a 
								<span id='details-admin-vote'></span>
								votes en faveur
								<span id="details-admin-membercount"></span>
								<span id="details-admin-seuil"></span>
								<span id='details-admin-didvote'></span>
							</p>

							<span id ="vote-list">

							</span>

							<span id="can-vote" style="display:none;">
								<button onclick="onVoteForAdminContract()" id="vote-for-admin" type="button" class="btn btn-lg btn-block btn-info mb-2">Voter pour</button>
							</span>

							<p>
								<span id="vote-status"></span>
							</p>

							<span id="seuil-enough" style="display:none;">
								<p>
									Lorsque le seuil requis est atteint, il est possible d'acter l'action d'administration :
								</p>

								<button onclick="onActAdminContract()" id="act-admin" type="button" class="btn btn-lg btn-block btn-info mb-2">Acter</button>

								<p>
									<span id="act-status"></span>
								</p>
							</span>

						</div>
					</ul>
				</div>
			</div>

			<a name="histo"></a>
			<div class="card mb-4 box-shadow">
				<div class="card-header">
					<h4 class="my-0 font-weight-normal"><a style="cursor: pointer; font-weight: bold;" onclick="toggleBlock('historique')">Votre historique</a></h4>
				</div>
				<div class="card-body histo-hide">
					<div id="event-histo"></div>
				</div>
			</div>

		</div>

		<div class="pricing-header mx-auto text-center">
			<p><span class="bold underline">Disclaimer</span> : Toute action sur la blockchain vous coutera un peu d'ether, y compris des actions non autorisées (vote dans une association pour laquelle vous n'êtes pas membre, activation d'un contrat d'administration qui n'a pas recueilli assez de vote etc. Il s'agit du fonctionnement normal qui consiste à dire que vous payez le fonctionnement d'un ordinateur mondial même si cela se termine par une exception)</p>
			<p>L'historique de toutes vos transaction (création de contrat d'association, manipulation de contrat ou réception d'ether) est toujours disponible dans l'extension/application MetaMask.</p>
		</div>

		<div>
			Credit :
			<span>Photo by <a href="https://unsplash.com/@davidshares?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">David Shares</a> on <a href="https://unsplash.com/s/photos/blockchain?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a></span>
		</div>
	</div>

	<div class="toast hide" role="alert" aria-live="assertive" aria-atomic="true" style="position: fixed; bottom: 50%; margin: 5% auto; left: 0; right: 0;">
		<div class="toast-header">
		  <strong class="mr-auto toast-header"></strong>
		  <button type="button" class="ml-2 mb-1 close" data-dismiss="toast" aria-label="Close">
		  <span aria-hidden="true">&times;</span>
		</button>
		</div>
		<div class="toast-body">
		</div>
	  </div>

	<!-- Bootstrap core JavaScript
    ================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->
	<script src="https://code.jquery.com/jquery-3.2.1.min.js" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
	<script type="text/javascript" src="js/web3helper.js"></script>
	<script type="text/javascript" src="js/curieux_generics.js"></script>
	<script type="text/javascript" src="js/curieux_storage.js"></script>
	<script type="text/javascript" src="js/curieux_ether.js"></script>
	<script type="text/javascript" src="js/curieux_create.js"></script>
	<script type="text/javascript" src="js/curieux.js"></script>
	<script>window.jQuery || document.write('<script src="js/vendor/jquery-slim.min.js"><\/script>')</script>
	<script src="js/vendor/popper.min.js"></script>
	<script src="js/bootstrap.min.js"></script>
	<script src="js/vendor/holder.min.js"></script>
	<script>
		Holder.addTheme('thumb', {
			bg: '#55595c',
			fg: '#eceeef',
			text: 'Thumbnail'
		});
	</script>

	<!-- Fathom - simple website analytics - https://github.com/usefathom/fathom -->
	<script>
	(function(f, a, t, h, o, m){
		a[h]=a[h]||function(){
			(a[h].q=a[h].q||[]).push(arguments)
		};
		o=f.createElement('script'),
		m=f.getElementsByTagName('script')[0];
		o.async=1; o.src=t; o.id='fathom-script';
		m.parentNode.insertBefore(o,m)
	})(document, window, '//analytics.issam.ma/tracker.js', 'fathom');
	fathom('set', 'siteId', 'COTTV');
	fathom('trackPageview');
	</script>
	<!-- / Fathom -->

</body>

</html>